# Проектная работа "Веб-ларек"

Стек: HTML, SCSS, TS, Webpack

Структура проекта:
- src/ — исходные файлы проекта
- src/components/ — папка с JS компонентами
- src/components/base/ — папка с базовым кодом

Важные файлы:
- src/pages/index.html — HTML-файл главной страницы
- src/types/index.ts — файл с типами
- src/index.ts — точка входа приложения
- src/scss/styles.scss — корневой файл стилей
- src/utils/constants.ts — файл с константами
- src/utils/utils.ts — файл с утилитами

## Установка и запуск
Для установки и запуска проекта необходимо выполнить команды

```
npm install
npm run start
```

или

```
yarn
yarn start
```
## Сборка

```
npm run build
```

или

```
yarn build
```
# web-larek-frontend

# Базовый код 

## Класс `EventEmitter`  
Это класс, который обеспечивает возможность установки и удаления слушателей для событий, а также вызов слушателей при возникновении этих событий.

Методы класса:

- `on` - устанавливает обработчик на событие
- `off` - сбрасывает обработчик с события
- `emit` - инициирует событие с данными
- `onAll` - устанавливает обработчик на все события
- `offAll` - сбрасывает обработчик на всех событиях
- `trigger` - устанавливает коллбэк-триггер, генерирующий заданное событие при вызове

## Класс `Api`
Служит оберткой для взаимодействия с API запросами. В его методах реализовано выполнение GET и POST запросов к указанному URL с использованием fetch API.

Конструктор класса:

-`constructor(baseUrl: string, options: RequestInit = {})` - принимает URL подключения к серверу и опции с запроса.

Методы класса:

- `handleResponse` - обрабатывает ответы сервера, преобразуя их в данные формата json или выдавая ошибки
- `get` - выполняет GET-запросы на сервер
- `post` - выполняет запрос с использованием предоставленого метода POST/PUT/DELETE

## Класс `Model` 
Абстрактный класс служит в качестве основной модели, на основе которой создаются другие модели в приложении.

Конструктор класса :

- `constructor(data: Partial<T>, protected events: IEvents)` - принимает данные и событие 

Методы класса:

- `emitChanges` - сообщает всем подписчикам, что модель поменялась

## Класс `Component<T>`
Является базовым классом для компонентов интерфейса. Класс является дженериком и принимает в переменной T тип данных, которые могут быть переданы в метод render для отображения.

Конструктор класса:

- `constructor(protected readonly container: HTMLElement)` - принимает элемент DOM для использования во вложенных компонентах.

Методы класса:

- `toggleClass` - переключает класс компонента
- `setText` - устанавливает текстовое содержимое для компонента
- `setDisabled` - меняет статус блокировки компонента
- `setHidden` - скрывает компонент
- `setVisible` - делает компонент видимым
- `setImage` - устанавливает для компонента изображение с альтернативным текстом
- `render` - возвращает корневой DOM-элемент




# Компоненты модели данных

## Класс `AppState`
Класс данных всего приложения наследуется от базового класса Model. Позволяет отслеживать состояние всего приложения. Содержит внутри себя свойства:
```
interface IAppState {
	catalog: ILot[];
	basket: ILot[];
	preview: string | null;
	order: IOrder | null;
	loading: boolean;
}
```

конструктор класса:

- `data: Partial<IAppState>, events: IEvents` - принимаем информацию и событие 

Поля класса :

- `catalog` - для отслеживания списка доступных лотов - установка данного свойства вызывает событие catalog:changed
- `basket` - отслеживание лотов, которые находятся в корзине.
- `order` - отслеживает состояние заказа
- `preview` - отслеживает лот, который используется для подробного изучения в модальном окне
- `formErrors` -  отслеживает валидацию форм при оформлении заказа

Методы класса :

- `setCatalog()` - определяет каталог карточек 
- `setPreview()` - показ выбранной карточки 
- `handleBasket()` - добавляет/удаляет карточку в/из корзины, исполузуя методы addToBasket()/deleteFromBasket()
- `addToBasket()` - добавляет карточку в корзину 
- `deleteFromBasket()` - удаляет карточку из корзины 
- `clearBasket()`- очищает корзину полностью 
- `deleteFromBasketTotal()` - очищает корзину по конкретным лотам 
- `getBasketLots` - получает все заказанные карточки
- `getTotal` - пределяет стоимость корзины 
- `setOrderField`- задаёт валидацию способа оплаты/адреса, телефон/почту используя методы  validateOrderAddress/validateOrderContact
- `validateOrderAddress` - валидация способа оплаты/адреса 
- `validateOrderContact` - - валидация телефона/почты 

## Класс `LotItem`
Класс данных отдельной карточки. Структура карточки определяется ответом от API - сервера с добавлением свойства и методов.

```
interface ILotItem {
	id: string;
	description: string;
	image: string;
	title: string;
	category: string;
	price: number | null;
	isOrdered:boolean;
}
```

# Компоненты представления

## Класс `Page` 
Отвечает за управление состоянием и отображением страницы в приложении.

Конструктор класса :

- `constructor(container: HTMLElement, protected events: IEvents)` - принимает элемент DOM и событие 

- `counter` - элемент отображения количества товаров в корзине
- `catalog` - элемент отображения всех доступных карточек
- `wrapper` - обёртка, позволяющая блокировать прокрутку страницы при открытии модального окна
- `basket` - кнопка для отображения корзины. Клик по кнопке вызывает событие basket:open

```
interface IPage {
    counter: number;
    catalog: HTMLElement[];
    locked: boolean;
}
```
## Класс `Modal`
Класс представления модального окна. Позволяет задать

```
interface IModalData {
	content: HTMLElement;
}

```
- `content` - для отображения внутреннего содержания модального окна
- `closeButton` - для отображения кнопки закрытия модального окна

конструктор класса: 
- `constructor(container: HTMLElement, protected events: IEvents)` - принимает элемент DOM и событие 

методы класса :
- `open() - открытие модального окна 
- `close() - закрытие модального окна 
- `render() - отрисовка модального окна 

## Класс `Card`
Класс карточки товара и отображения ее данных.

```
interface ICard {
	title: string;
	description?: string | string[];
	image: string;
	price: number | null;
	category: string;
	button?: boolean;
}
```
Поля класса:

- `id` - отслеживание id карточки 
- `title` - отслеживание заголовка карточки 
- `image` - ослеживание картинки карточки 
- `description` - ослеживание описания карточки 
- `button` - отслеживание кноки крточки 
- `categoty` -отслеживание категории карточки 
- `price` - отслеживание цены карточки  

конструктор класса:
- `constructor(protected blockName: string, container: HTMLElement,actions: ICardActions)` принимает имя блока, элемент DOM и действие над карточкой 

## Класс `Basket`
Класс представления корзины. Позволяет задать:

```
interface IBasketItem {
	title: string;
	id: number;
	price: string | number;
}
```
Конструктор класса :

- `constructor(container: HTMLElement, protected events: EventEmitter)` - принимает элемент DOM и событие 

- `list` - список отображаемых элементов в корзине
- `total` - общую ценность корзины
- `button` - кнопку открытия формы оформления заказа.

# Класс `Basketitem`
Класс представления элемента заказа в корзине.

```
interface IBasketItem {
	title: string;
	id: number;
	price: string | number;
}
```
Конструктор класса :

- `constructor(container: HTMLElement, actions?: IClick)` - принимает элемент DOM и действие над элементом корзины 

методы класса :

- `title()` - задаёт название лота
- `id()` - задаёт id лота 
- `price()` - задаёт цену лота

## Класс `Form` 
Класс представления базовой формы. Позволяет задать:

```
interface IFormState {
	valid: boolean;
	errors: string[];
}
```
- `submit` - кнопку отправки формы
- `errors` - блок отображения ошибок в форме



## Класс `OrderContact и OrderAddress`
Класс данных процесса оформления заказа. Содержит свойства, которые отображаются на полях соответствующих форм и реализует простейшую логику валидации свойств на наличие значений.
- `email` - почта для связи
- `phone` - телефон для связи

- `payment` - способ оплаты
- `address` - адрес доставки

```
interface IOrderAddressForm {
	address: string;
	payment: string;
}

interface IOrderContactsForm {
	email: string;
	phone: string;
}

```
## Класс `Success`
Класс представления, определяющий отображение основной информации об оформленном заказе:

```
interface ISuccess {
	total: number;
}
```

- `total` - общая сумма заказа


# Внешние связи 

## Класс LarekAPI 
Класс взаимодействия с конкретным API-сервером расширяет класс api. Реализует такие методы, как:

Методы класса:

- `getLotItem` - для чтения информации по конкретному лоту
- `getLotList` - для чтения информации по всем доступным лотам
- `orderLots` - оформления заказа через соответствующий запрос на сервер

# События
## Cписок основных событий:
	-'catalog:changed' - загрузка доступных лотов 
	-'card:open' - открытие карточки лота для просмотра
	-'basket:open' - открытие карзины
	-'lot:changed' - добавление/удаление из корзины карточка 
	-'basket:delItem'- удаление из корзины по кнопке в корзине
    -'modal:open' - открытие модального окна 
	-'modal:close' - закрытие модального окна
	-'order:open' - открытие формы с выбором оплаты и вводом адреса
	-'order:submit' - подтверждение адреса и способа оплаты/открытие формы заполнения телефона и почты
	-'contacts:submit' -  подтверждение заполнение формы с контактными данными и открытие модального окна успешного оформления
	-'order.payment:change' - изменение способа оплаты 
	-'formErrors:change'- валидация способа оплаты и адреса  


