# Проектная работа "Веб-ларек"

Стек: HTML, SCSS, TS, Webpack

Структура проекта:
- src/ — исходные файлы проекта
- src/components/ — папка с JS компонентами
- src/components/base/ — папка с базовым кодом

Важные файлы:
- src/pages/index.html — HTML-файл главной страницы
- src/types/index.ts — файл с типами
- src/index.ts — точка входа приложения
- src/scss/styles.scss — корневой файл стилей
- src/utils/constants.ts — файл с константами
- src/utils/utils.ts — файл с утилитами

## Установка и запуск
Для установки и запуска проекта необходимо выполнить команды

```
npm install
npm run start
```

или

```
yarn
yarn start
```
## Сборка

```
npm run build
```

или

```
yarn build
```
# web-larek-frontend

# Базовый код 

## Класс `EventEmitter`  
Это класс, который обеспечивает возможность установки и удаления слушателей для событий, а также вызов слушателей при возникновении этих событий.

Методы класса:

- `on` - устанавливает обработчик на событие
- `off` - сбрасывает обработчик с события
- `emit` - инициирует событие с данными
- `onAll` - устанавливает обработчик на все события
- `offAll` - сбрасывает обработчик на всех событиях
- `trigger` - устанавливает коллбэк-триггер, генерирующий заданное событие при вызове

## Класс `Api`
Служит оберткой для взаимодействия с API запросами. В его методах реализовано выполнение GET и POST запросов к указанному URL с использованием fetch API.

Методы класса:

- `handleResponse` - обрабатывает ответы сервера, преобразуя их в данные формата json или выдавая ошибки
- `get` - выполняет GET-запросы на сервер
- `post` - выполняет запрос с использованием предоставленого метода POST/PUT/DELETE

## Класс `Model` 
Служит в качестве основной модели, на основе которой создаются другие модели в приложении.

Методы класса:

- `emitChanges` - сообщает всем подписчикам, что модель поменялась

## Класс `Component`
Является основным компонентом, предназначенным для создания других компонентов в приложении. Он обладает методами для взаимодействия с DOM-элементами, такими как установка текстового содержимого, изменение классов, управление состоянием блокировки элемента, скрытие и отображение элементов, а также установка изображения с альтернативным текстом. Метод render применяется для отображения компонента на основе предоставленных данных и возврата корневого DOM-элемента компонента.

Методы класса:

- `toggleClass` - переключает класс компонента
- `setText` - устанавливает текстовое содержимое для компонента
- `setDisabled` - меняет статус блокировки компонента
- `setHidden` - скрывает компонент
- `setVisible` - делает компонент видимым
- `setImage` - устанавливает для компонента изображение с альтернативным текстом
- `render` - возвращает корневой DOM-элемент




# Компоненты модели данных

## Класс `AppState`
Класс данных всего приложения. Позволяет отслеживать состояние всего приложения. Содержит внутри себя свойство:

- `catalog` - для отслеживания списка доступных лотов - установка данного свойства вызывает событие catalog:changed
- `basket` - отслеживание лотов, которые находятся в корзине.
- `order` - отслеживает состояние заказа
- `preview` - отслеживает лот, который используется для подробного изучения в модальном окне


```
interface IAppState {
	catalog: ILot[];
	basket: ILot[];
	preview: string | null;
	order: IOrder | null;
	loading: boolean;
}
```

## Класс `LotItem`
Класс данных отдельной карточки. Структура карточки определяется ответом от API - сервера с добавлением свойства и методов.

```
interface ILotItem {
	id: string;
	description: string;
	image: string;
	title: string;
	category: string;
	price: number | null;
	isOrdered:boolean;
}
```

## Класс `OrderContact и OrderAddress`
Класс данных процесса оформления заказа. Содержит свойства, которые отображаются на полях соответствующих форм и реализует простейшую логику валидации свойств на наличие значений.
- `email` - почта для связи
- `phone` - телефон для связи

- `payment` - способ оплаты
- `address` - адрес доставки

```
interface IOrderAddressForm {
	address: string;
	payment: string;
}

interface IOrderContactsForm {
	email: string;
	phone: string;
}

```

# Компоненты представления

## Класс `Page` 
Отвечает за управление состоянием и отображением страницы в приложении.

- `counter` - элемент отображения количества товаров в корзине
- `catalog` - элемент отображения всех доступных карточек
- `wrapper` - обёртка, позволяющая блокировать прокрутку страницы при открытии модального окна
- `basket` - кнопка для отображения корзины. Клик по кнопке вызывает событие basket:open

```
interface IPage {
    counter: number;
    catalog: HTMLElement[];
    locked: boolean;
}
```
## Класс `Modal`
Класс представления модального окна. Позволяет задать

- `content` - для отображения внутреннего содержания модального окна
- `closeButton` - для отображения кнопки закрытия модального окна

## Класс `Card`
Класс карточки товара и отображения ее данных.

## Класс `Basket`
Класс представления корзины. Позволяет задать:

- `list` - список отображаемых элементов в корзине
- `total` - общую ценность корзины
- `button` - кнопку открытия формы оформления заказа.

## Класс `Form` 
Класс представления базовой формы. Позволяет задать:

- `submit` - кнопку отправки формы
- `errors` - блок отображения ошибок в форме


## Класс `Success`
Класс представления, определяющий отображение основной информации об оформленном заказе:

- `total` - общая сумма заказа (забираем из ответа сервера)


# Внешние связи 

## Класс LarekAPI 
Класс взаимодействия с конкретным API-сервером. Реализует такие методы, как:

Методы класса:

- `getLotItem` - для чтения информации по конкретному лоту
- `getLotList` - для чтения информации по всем доступным лотам
- `postOrderLots` - оформления заказа через соответствующий запрос на сервер

# События
## Cписок основных событий:
	-'catalog:changed' - загрузка доступных лотов 
	-'card:open' - открытие карточки лота для просмотра
	-'basket:open' - открытие карзины
	-'lot:changed' - добавление/удаление из корзины карточка 
	-'basket:delItem'- удаление из корзины по кнопке в корзине
    -'modal:open' - открытие модального окна 
	-'modal:close' - закрытие модального окна
	-'order:open' - открытие формы с выбором оплаты и вводом адреса
	-'order:submit' - подтверждение адреса и способа оплаты/открытие формы заполнения телефона и почты
	-'contacts:submit' -  подтверждение заполнение формы с контактными данными и открытие модального окна успешного оформления
	-'order.payment:change' - изменение способа оплаты 
	-'order.addres':change' - изменение адреса 
	-'contacts.email':change' - изменение почты 
	-'contacts.phone':change' - изменение телефона 
	-'formErrorsContact:change' - валидация почты и номера  
	-'formErrors:change'- валидация способа оплаты и адреса  


